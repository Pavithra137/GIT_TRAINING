name: Permission

on:
  workflow_dispatch:
    inputs:
      PR_URL:
        
  push:
    branches:
      - feature/permissions
permissions:
  contents: read
  issues: write

jobs:
  issue_example:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4.2.2

      - name: Authenticate GH CLI
        run: echo "${{ secrets.TOKEN }}" | gh auth login --with-token

      - name: Create an Issue
        run: |
          gh issue create \
            --title " Automated Issue from GitHub Actions" \
            --body "This issue was auto-generated by a workflow run." \
            --label "bug"

  Auto_merge:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4.2.2

      - name: Enable Auto-Merge
        run: |
          gh pr merge "$PR_URL" --auto --merge --delete-branch --repo "$REPO"
        env:
          GH_TOKEN: ${{ secrets.GH_TOKEN }}
          PR_URL: ${{ github.event.issue.pull_request.html_url }}
          REPO: ${{ github.repository }}
        
  
